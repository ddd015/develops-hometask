version: '3.5'

services:
  nexus:
    build:
      context: ./nexus/ #file path Doskerfile.multi
      dockerfile: Dockerfile
    image: nexus
    container_name: nexus
    ports:
    - 8081:8081
    networks:
    - nginx-net

  jenkins:
    build:
      context: ./jenkins/ #file path Doskerfile.multi
      dockerfile: Dockerfile
    image: jenkins
    privileged: true
    container_name: jenkins
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - jenkins_vol:/var/lib/jenkins/workspace/
    ports:
    - 8080:8080
    networks:
    - nginx-net

#  nginx:
#    image: nginx
#    container_name: nginx
#    ports:
#    - "8080:8080"
#    - "8081:8081"
#    networks:
#    - nginx-net
#    depends_on:
#    - nexus
#    - jenkins
#    volumes:
#    - ./nginx/nginx.conf:/etc/nginx/nginx.conf

networks:
  nginx-net: {}
volumes:
  jenkins_vol: